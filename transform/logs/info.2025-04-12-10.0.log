2025-04-12 10:57:56 [main] INFO  o.s.t.kafka.consumer.ConsumerManager - Starting 6 consumers for the 'contacts' topic...
2025-04-12 10:57:56 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-contacts-test-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = true
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = contacts-test-group
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 100
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

2025-04-12 10:57:56 [main] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:57:57 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:57:57 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:57:57 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455477393
2025-04-12 10:57:57 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-contacts-test-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = true
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = contacts-test-group
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 100
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

2025-04-12 10:57:57 [main] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:57:57 [Worker-1] INFO  o.a.k.c.c.i.LegacyKafkaConsumer - [Consumer clientId=consumer-contacts-test-group-1, groupId=contacts-test-group] Subscribed to topic(s): test-topic
2025-04-12 10:57:57 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Consuming messages from topic: test-topic
2025-04-12 10:57:57 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:57:57 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:57:57 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455477437
2025-04-12 10:57:57 [Worker-2] INFO  o.a.k.c.c.i.LegacyKafkaConsumer - [Consumer clientId=consumer-contacts-test-group-2, groupId=contacts-test-group] Subscribed to topic(s): test-topic
2025-04-12 10:57:57 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-contacts-test-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = true
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = contacts-test-group
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 100
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

2025-04-12 10:57:57 [Worker-2] INFO  o.s.t.k.consumer.ConsumerTemplate - Consuming messages from topic: test-topic
2025-04-12 10:57:57 [main] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:57:57 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:57:57 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:57:57 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455477471
2025-04-12 10:57:57 [Worker-3] INFO  o.a.k.c.c.i.LegacyKafkaConsumer - [Consumer clientId=consumer-contacts-test-group-3, groupId=contacts-test-group] Subscribed to topic(s): test-topic
2025-04-12 10:57:57 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-contacts-test-group-4
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = true
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = contacts-test-group
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 100
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

2025-04-12 10:57:57 [Worker-3] INFO  o.s.t.k.consumer.ConsumerTemplate - Consuming messages from topic: test-topic
2025-04-12 10:57:57 [main] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:57:57 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:57:57 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:57:57 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455477498
2025-04-12 10:57:57 [Worker-4] INFO  o.a.k.c.c.i.LegacyKafkaConsumer - [Consumer clientId=consumer-contacts-test-group-4, groupId=contacts-test-group] Subscribed to topic(s): test-topic
2025-04-12 10:57:57 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-contacts-test-group-5
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = true
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = contacts-test-group
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 100
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

2025-04-12 10:57:57 [Worker-4] INFO  o.s.t.k.consumer.ConsumerTemplate - Consuming messages from topic: test-topic
2025-04-12 10:57:57 [main] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:57:57 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:57:57 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:57:57 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455477521
2025-04-12 10:57:57 [Worker-5] INFO  o.a.k.c.c.i.LegacyKafkaConsumer - [Consumer clientId=consumer-contacts-test-group-5, groupId=contacts-test-group] Subscribed to topic(s): test-topic
2025-04-12 10:57:57 [Worker-5] INFO  o.s.t.k.consumer.ConsumerTemplate - Consuming messages from topic: test-topic
2025-04-12 10:57:57 [main] INFO  o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-contacts-test-group-6
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = true
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = contacts-test-group
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 100
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

2025-04-12 10:57:57 [main] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:57:57 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:57:57 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:57:57 [main] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455477545
2025-04-12 10:57:57 [main] INFO  o.s.t.kafka.consumer.ConsumerManager - Started 6 consumers for the 'contacts' topic.
2025-04-12 10:57:57 [Worker-6] INFO  o.a.k.c.c.i.LegacyKafkaConsumer - [Consumer clientId=consumer-contacts-test-group-6, groupId=contacts-test-group] Subscribed to topic(s): test-topic
2025-04-12 10:57:57 [Worker-6] INFO  o.s.t.k.consumer.ConsumerTemplate - Consuming messages from topic: test-topic
2025-04-12 10:57:58 [Worker-5] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-contacts-test-group-5, groupId=contacts-test-group] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:57:58 [Worker-4] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-contacts-test-group-4, groupId=contacts-test-group] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:57:58 [Worker-1] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-contacts-test-group-1, groupId=contacts-test-group] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:57:58 [Worker-3] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-contacts-test-group-3, groupId=contacts-test-group] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:57:58 [Worker-2] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-contacts-test-group-2, groupId=contacts-test-group] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:57:58 [Worker-6] INFO  org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-contacts-test-group-6, groupId=contacts-test-group] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:57:58 [Worker-4] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-4, groupId=contacts-test-group] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-04-12 10:57:58 [Worker-5] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-5, groupId=contacts-test-group] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-04-12 10:57:58 [Worker-2] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-2, groupId=contacts-test-group] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-04-12 10:57:58 [Worker-3] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-3, groupId=contacts-test-group] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-04-12 10:57:58 [Worker-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-1, groupId=contacts-test-group] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-04-12 10:57:58 [Worker-6] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-6, groupId=contacts-test-group] Discovered group coordinator localhost:9092 (id: 2147483646 rack: null)
2025-04-12 10:57:58 [Worker-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-1, groupId=contacts-test-group] (Re-)joining group
2025-04-12 10:57:58 [Worker-4] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-4, groupId=contacts-test-group] (Re-)joining group
2025-04-12 10:57:58 [Worker-5] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-5, groupId=contacts-test-group] (Re-)joining group
2025-04-12 10:57:58 [Worker-3] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-3, groupId=contacts-test-group] (Re-)joining group
2025-04-12 10:57:58 [Worker-2] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-2, groupId=contacts-test-group] (Re-)joining group
2025-04-12 10:57:58 [Worker-6] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-6, groupId=contacts-test-group] (Re-)joining group
2025-04-12 10:57:58 [Worker-2] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-2, groupId=contacts-test-group] Request joining group due to: need to re-join with the given member-id: consumer-contacts-test-group-2-9edd3811-cff6-4a0e-9c34-e8f857068d9f
2025-04-12 10:57:58 [Worker-4] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-4, groupId=contacts-test-group] Request joining group due to: need to re-join with the given member-id: consumer-contacts-test-group-4-eb8eccd9-73bb-4a33-b0d1-b7493d87a345
2025-04-12 10:57:58 [Worker-2] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-2, groupId=contacts-test-group] (Re-)joining group
2025-04-12 10:57:58 [Worker-5] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-5, groupId=contacts-test-group] Request joining group due to: need to re-join with the given member-id: consumer-contacts-test-group-5-f6a3bbbe-b884-417b-bbec-854f46512913
2025-04-12 10:57:58 [Worker-4] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-4, groupId=contacts-test-group] (Re-)joining group
2025-04-12 10:57:58 [Worker-3] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-3, groupId=contacts-test-group] Request joining group due to: need to re-join with the given member-id: consumer-contacts-test-group-3-e98420c2-1527-4395-b038-46e9d93a736c
2025-04-12 10:57:58 [Worker-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-1, groupId=contacts-test-group] Request joining group due to: need to re-join with the given member-id: consumer-contacts-test-group-1-1dd619fa-8c64-46ab-900d-221bcc682ce4
2025-04-12 10:57:58 [Worker-6] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-6, groupId=contacts-test-group] Request joining group due to: need to re-join with the given member-id: consumer-contacts-test-group-6-a1cae8df-6e08-4489-b7b8-5758c7d0d90d
2025-04-12 10:57:58 [Worker-5] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-5, groupId=contacts-test-group] (Re-)joining group
2025-04-12 10:57:58 [Worker-3] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-3, groupId=contacts-test-group] (Re-)joining group
2025-04-12 10:57:58 [Worker-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-1, groupId=contacts-test-group] (Re-)joining group
2025-04-12 10:57:58 [Worker-6] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-6, groupId=contacts-test-group] (Re-)joining group
2025-04-12 10:58:01 [Worker-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-1, groupId=contacts-test-group] Successfully joined group with generation Generation{generationId=83, memberId='consumer-contacts-test-group-1-1dd619fa-8c64-46ab-900d-221bcc682ce4', protocol='range'}
2025-04-12 10:58:01 [Worker-2] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-2, groupId=contacts-test-group] Successfully joined group with generation Generation{generationId=83, memberId='consumer-contacts-test-group-2-9edd3811-cff6-4a0e-9c34-e8f857068d9f', protocol='range'}
2025-04-12 10:58:01 [Worker-2] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-2, groupId=contacts-test-group] Finished assignment for group at generation 83: {consumer-contacts-test-group-3-e98420c2-1527-4395-b038-46e9d93a736c=Assignment(partitions=[]), consumer-contacts-test-group-6-a1cae8df-6e08-4489-b7b8-5758c7d0d90d=Assignment(partitions=[]), consumer-contacts-test-group-4-eb8eccd9-73bb-4a33-b0d1-b7493d87a345=Assignment(partitions=[]), consumer-contacts-test-group-2-9edd3811-cff6-4a0e-9c34-e8f857068d9f=Assignment(partitions=[]), consumer-contacts-test-group-1-1dd619fa-8c64-46ab-900d-221bcc682ce4=Assignment(partitions=[test-topic-0]), consumer-contacts-test-group-5-f6a3bbbe-b884-417b-bbec-854f46512913=Assignment(partitions=[])}
2025-04-12 10:58:01 [Worker-3] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-3, groupId=contacts-test-group] Successfully joined group with generation Generation{generationId=83, memberId='consumer-contacts-test-group-3-e98420c2-1527-4395-b038-46e9d93a736c', protocol='range'}
2025-04-12 10:58:01 [Worker-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-1, groupId=contacts-test-group] Successfully synced group in generation Generation{generationId=83, memberId='consumer-contacts-test-group-1-1dd619fa-8c64-46ab-900d-221bcc682ce4', protocol='range'}
2025-04-12 10:58:01 [Worker-2] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-2, groupId=contacts-test-group] Successfully synced group in generation Generation{generationId=83, memberId='consumer-contacts-test-group-2-9edd3811-cff6-4a0e-9c34-e8f857068d9f', protocol='range'}
2025-04-12 10:58:01 [Worker-3] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-3, groupId=contacts-test-group] Successfully synced group in generation Generation{generationId=83, memberId='consumer-contacts-test-group-3-e98420c2-1527-4395-b038-46e9d93a736c', protocol='range'}
2025-04-12 10:58:01 [Worker-1] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-1, groupId=contacts-test-group] Notifying assignor about the new Assignment(partitions=[test-topic-0])
2025-04-12 10:58:01 [Worker-2] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-2, groupId=contacts-test-group] Notifying assignor about the new Assignment(partitions=[])
2025-04-12 10:58:01 [Worker-3] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-3, groupId=contacts-test-group] Notifying assignor about the new Assignment(partitions=[])
2025-04-12 10:58:01 [Worker-3] INFO  o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-contacts-test-group-3, groupId=contacts-test-group] Adding newly assigned partitions: 
2025-04-12 10:58:01 [Worker-2] INFO  o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-contacts-test-group-2, groupId=contacts-test-group] Adding newly assigned partitions: 
2025-04-12 10:58:01 [Worker-1] INFO  o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-contacts-test-group-1, groupId=contacts-test-group] Adding newly assigned partitions: test-topic-0
2025-04-12 10:58:01 [Worker-4] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-4, groupId=contacts-test-group] Successfully joined group with generation Generation{generationId=83, memberId='consumer-contacts-test-group-4-eb8eccd9-73bb-4a33-b0d1-b7493d87a345', protocol='range'}
2025-04-12 10:58:01 [Worker-4] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-4, groupId=contacts-test-group] Successfully synced group in generation Generation{generationId=83, memberId='consumer-contacts-test-group-4-eb8eccd9-73bb-4a33-b0d1-b7493d87a345', protocol='range'}
2025-04-12 10:58:01 [Worker-4] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-4, groupId=contacts-test-group] Notifying assignor about the new Assignment(partitions=[])
2025-04-12 10:58:01 [Worker-4] INFO  o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-contacts-test-group-4, groupId=contacts-test-group] Adding newly assigned partitions: 
2025-04-12 10:58:01 [Worker-1] INFO  o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition test-topic-0 to the committed offset FetchPosition{offset=70349, offsetEpoch=Optional[2], currentLeader=LeaderAndEpoch{leader=Optional[localhost:9092 (id: 1 rack: null)], epoch=12}}
2025-04-12 10:58:01 [Worker-5] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-5, groupId=contacts-test-group] Successfully joined group with generation Generation{generationId=83, memberId='consumer-contacts-test-group-5-f6a3bbbe-b884-417b-bbec-854f46512913', protocol='range'}
2025-04-12 10:58:01 [Worker-5] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-5, groupId=contacts-test-group] Successfully synced group in generation Generation{generationId=83, memberId='consumer-contacts-test-group-5-f6a3bbbe-b884-417b-bbec-854f46512913', protocol='range'}
2025-04-12 10:58:01 [Worker-5] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-5, groupId=contacts-test-group] Notifying assignor about the new Assignment(partitions=[])
2025-04-12 10:58:01 [Worker-5] INFO  o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-contacts-test-group-5, groupId=contacts-test-group] Adding newly assigned partitions: 
2025-04-12 10:58:01 [Worker-6] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-6, groupId=contacts-test-group] Successfully joined group with generation Generation{generationId=83, memberId='consumer-contacts-test-group-6-a1cae8df-6e08-4489-b7b8-5758c7d0d90d', protocol='range'}
2025-04-12 10:58:01 [Worker-6] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-6, groupId=contacts-test-group] Successfully synced group in generation Generation{generationId=83, memberId='consumer-contacts-test-group-6-a1cae8df-6e08-4489-b7b8-5758c7d0d90d', protocol='range'}
2025-04-12 10:58:01 [Worker-6] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-6, groupId=contacts-test-group] Notifying assignor about the new Assignment(partitions=[])
2025-04-12 10:58:01 [Worker-6] INFO  o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-contacts-test-group-6, groupId=contacts-test-group] Adding newly assigned partitions: 
2025-04-12 10:58:01 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_70, value: {"_id": {"$oid": "67f10b97558ab0f6396b1450"}, "review": "Not bad, not great either.", "authId": "user_70", "datetime": "2025-02-04T17:31:50.204Z", "sentiment": null}, offset: 70349
2025-04-12 10:58:01 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_70
2025-04-12 10:58:04 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1450"}, "review": "Not bad, not great either.", "authId": "user_70", "datetime": "2025-02-04T17:31:50.204Z", "sentiment": null}%n
2025-04-12 10:58:04 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.4
score: -0.4

2025-04-12 10:58:05 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.4
score: -0.4

2025-04-12 10:58:05 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:05 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:05 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-1] Instantiated an idempotent producer.
2025-04-12 10:58:05 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:05 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:05 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455485170
2025-04-12 10:58:05 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:05 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_70', sentiment=magnitude: 0.4
score: -0.4
}
2025-04-12 10:58:05 [kafka-producer-network-thread | producer-1] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-1] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:05 [kafka-producer-network-thread | producer-1] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-1] ProducerId set to 7005 with epoch 0
2025-04-12 10:58:05 [kafka-producer-network-thread | producer-1] WARN  o.apache.kafka.clients.NetworkClient - [Producer clientId=producer-1] Error while fetching metadata with correlation id 5 : {processed-data-topic=UNKNOWN_TOPIC_OR_PARTITION}
2025-04-12 10:58:05 [kafka-producer-network-thread | producer-1] WARN  o.apache.kafka.clients.NetworkClient - [Producer clientId=producer-1] Error while fetching metadata with correlation id 6 : {processed-data-topic=UNKNOWN_TOPIC_OR_PARTITION}
2025-04-12 10:58:05 [kafka-producer-network-thread | producer-1] WARN  o.apache.kafka.clients.NetworkClient - [Producer clientId=producer-1] Error while fetching metadata with correlation id 7 : {processed-data-topic=UNKNOWN_TOPIC_OR_PARTITION}
2025-04-12 10:58:06 [kafka-producer-network-thread | producer-1] WARN  o.apache.kafka.clients.NetworkClient - [Producer clientId=producer-1] Error while fetching metadata with correlation id 8 : {processed-data-topic=UNKNOWN_TOPIC_OR_PARTITION}
2025-04-12 10:58:07 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:07 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_81, value: {"_id": {"$oid": "67f10b97558ab0f6396b145b"}, "review": "Not bad, not great either.", "authId": "user_81", "datetime": "2025-03-11T12:19:55.240Z", "sentiment": null}, offset: 70350
2025-04-12 10:58:07 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_81
2025-04-12 10:58:08 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b145b"}, "review": "Not bad, not great either.", "authId": "user_81", "datetime": "2025-03-11T12:19:55.240Z", "sentiment": null}%n
2025-04-12 10:58:08 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.5
score: -0.5

2025-04-12 10:58:08 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.5
score: -0.5

2025-04-12 10:58:08 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-2
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:08 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:08 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-2] Instantiated an idempotent producer.
2025-04-12 10:58:08 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:08 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:08 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455488098
2025-04-12 10:58:08 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:08 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_81', sentiment=magnitude: 0.5
score: -0.5
}
2025-04-12 10:58:08 [kafka-producer-network-thread | producer-2] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-2] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:08 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:08 [kafka-producer-network-thread | producer-2] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-2] ProducerId set to 7006 with epoch 0
2025-04-12 10:58:08 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_24, value: {"_id": {"$oid": "67f10b97558ab0f6396b1422"}, "review": "Would not recommend to anyone.", "authId": "user_24", "datetime": "2025-02-23T15:21:37.169Z", "sentiment": null}, offset: 70351
2025-04-12 10:58:08 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_24
2025-04-12 10:58:09 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1422"}, "review": "Would not recommend to anyone.", "authId": "user_24", "datetime": "2025-02-23T15:21:37.169Z", "sentiment": null}%n
2025-04-12 10:58:09 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.6
score: -0.6

2025-04-12 10:58:09 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.6
score: -0.6

2025-04-12 10:58:09 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-3
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:09 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:09 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-3] Instantiated an idempotent producer.
2025-04-12 10:58:09 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:09 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:09 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455489668
2025-04-12 10:58:09 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:09 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_24', sentiment=magnitude: 0.6
score: -0.6
}
2025-04-12 10:58:09 [kafka-producer-network-thread | producer-3] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-3] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:09 [kafka-producer-network-thread | producer-3] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-3] ProducerId set to 7007 with epoch 0
2025-04-12 10:58:09 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:09 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_44, value: {"_id": {"$oid": "67f10b97558ab0f6396b1436"}, "review": "Not bad, not great either.", "authId": "user_44", "datetime": "2024-12-21T16:54:59.782Z", "sentiment": null}, offset: 70352
2025-04-12 10:58:09 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_44
2025-04-12 10:58:10 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1436"}, "review": "Not bad, not great either.", "authId": "user_44", "datetime": "2024-12-21T16:54:59.782Z", "sentiment": null}%n
2025-04-12 10:58:10 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.4
score: -0.4

2025-04-12 10:58:10 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.4
score: -0.4

2025-04-12 10:58:10 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-4
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:10 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:10 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-4] Instantiated an idempotent producer.
2025-04-12 10:58:10 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:10 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:10 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455490247
2025-04-12 10:58:10 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:10 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_44', sentiment=magnitude: 0.4
score: -0.4
}
2025-04-12 10:58:10 [kafka-producer-network-thread | producer-4] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-4] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:10 [kafka-producer-network-thread | producer-4] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-4] ProducerId set to 7008 with epoch 0
2025-04-12 10:58:10 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:10 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_48, value: {"_id": {"$oid": "67f10b97558ab0f6396b143a"}, "review": "Terrible experience, very disappointed.", "authId": "user_48", "datetime": "2025-01-15T02:57:46.191Z", "sentiment": null}, offset: 70353
2025-04-12 10:58:10 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_48
2025-04-12 10:58:10 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b143a"}, "review": "Terrible experience, very disappointed.", "authId": "user_48", "datetime": "2025-01-15T02:57:46.191Z", "sentiment": null}%n
2025-04-12 10:58:10 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:10 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:10 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-5
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:10 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:10 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-5] Instantiated an idempotent producer.
2025-04-12 10:58:10 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:10 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:10 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455490823
2025-04-12 10:58:10 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:10 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_48', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:10 [kafka-producer-network-thread | producer-5] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-5] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:10 [kafka-producer-network-thread | producer-5] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-5] ProducerId set to 7009 with epoch 0
2025-04-12 10:58:10 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:10 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_91, value: {"_id": {"$oid": "67f10b97558ab0f6396b1465"}, "review": "Im very happy with this purchase!", "authId": "user_91", "datetime": "2025-03-06T05:11:20.005Z", "sentiment": null}, offset: 70354
2025-04-12 10:58:10 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_91
2025-04-12 10:58:11 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1465"}, "review": "Im very happy with this purchase!", "authId": "user_91", "datetime": "2025-03-06T05:11:20.005Z", "sentiment": null}%n
2025-04-12 10:58:11 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.2
score: 0.2

2025-04-12 10:58:11 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.2
score: 0.2

2025-04-12 10:58:11 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-6
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:11 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:11 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-6] Instantiated an idempotent producer.
2025-04-12 10:58:11 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:11 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:11 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455491478
2025-04-12 10:58:11 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:11 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_91', sentiment=magnitude: 0.2
score: 0.2
}
2025-04-12 10:58:11 [kafka-producer-network-thread | producer-6] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-6] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:11 [kafka-producer-network-thread | producer-6] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-6] ProducerId set to 7010 with epoch 0
2025-04-12 10:58:11 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:11 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_1, value: {"_id": {"$oid": "67f10b97558ab0f6396b140b"}, "review": "Would not recommend to anyone.", "authId": "user_1", "datetime": "2025-02-11T21:08:49.821Z", "sentiment": null}, offset: 70355
2025-04-12 10:58:11 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_1
2025-04-12 10:58:13 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b140b"}, "review": "Would not recommend to anyone.", "authId": "user_1", "datetime": "2025-02-11T21:08:49.821Z", "sentiment": null}%n
2025-04-12 10:58:13 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:13 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:13 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-7
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:13 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:13 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-7] Instantiated an idempotent producer.
2025-04-12 10:58:13 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:13 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:13 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455493071
2025-04-12 10:58:13 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:13 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_1', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:13 [kafka-producer-network-thread | producer-7] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-7] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:13 [kafka-producer-network-thread | producer-7] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-7] ProducerId set to 7011 with epoch 0
2025-04-12 10:58:13 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:13 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_78, value: {"_id": {"$oid": "67f10b97558ab0f6396b1458"}, "review": "Some features are good, others not so much.", "authId": "user_78", "datetime": "2025-03-27T01:59:52.899Z", "sentiment": null}, offset: 70356
2025-04-12 10:58:13 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_78
2025-04-12 10:58:13 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1458"}, "review": "Some features are good, others not so much.", "authId": "user_78", "datetime": "2025-03-27T01:59:52.899Z", "sentiment": null}%n
2025-04-12 10:58:13 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.4
score: -0.4

2025-04-12 10:58:13 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.4
score: -0.4

2025-04-12 10:58:13 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-8
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:13 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:13 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-8] Instantiated an idempotent producer.
2025-04-12 10:58:13 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:13 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:13 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455493635
2025-04-12 10:58:13 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:13 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_78', sentiment=magnitude: 0.4
score: -0.4
}
2025-04-12 10:58:13 [kafka-producer-network-thread | producer-8] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-8] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:13 [kafka-producer-network-thread | producer-8] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-8] ProducerId set to 7012 with epoch 0
2025-04-12 10:58:13 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:13 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_19, value: {"_id": {"$oid": "67f10b97558ab0f6396b141d"}, "review": "This changed my life!", "authId": "user_19", "datetime": "2025-03-03T03:16:33.431Z", "sentiment": null}, offset: 70357
2025-04-12 10:58:13 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_19
2025-04-12 10:58:14 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b141d"}, "review": "This changed my life!", "authId": "user_19", "datetime": "2025-03-03T03:16:33.431Z", "sentiment": null}%n
2025-04-12 10:58:14 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.2
score: -0.2

2025-04-12 10:58:14 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.2
score: -0.2

2025-04-12 10:58:14 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-9
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:14 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:14 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-9] Instantiated an idempotent producer.
2025-04-12 10:58:14 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:14 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:14 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455494240
2025-04-12 10:58:14 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:14 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_19', sentiment=magnitude: 0.2
score: -0.2
}
2025-04-12 10:58:14 [kafka-producer-network-thread | producer-9] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-9] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:14 [kafka-producer-network-thread | producer-9] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-9] ProducerId set to 7013 with epoch 0
2025-04-12 10:58:14 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:14 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_29, value: {"_id": {"$oid": "67f10b97558ab0f6396b1427"}, "review": "Very bad quality, feels cheap.", "authId": "user_29", "datetime": "2025-03-11T08:35:47.362Z", "sentiment": null}, offset: 70358
2025-04-12 10:58:14 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_29
2025-04-12 10:58:15 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1427"}, "review": "Very bad quality, feels cheap.", "authId": "user_29", "datetime": "2025-03-11T08:35:47.362Z", "sentiment": null}%n
2025-04-12 10:58:15 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:15 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:15 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-10
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:15 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:15 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-10] Instantiated an idempotent producer.
2025-04-12 10:58:15 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:15 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:15 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455495783
2025-04-12 10:58:15 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:15 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_29', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:15 [kafka-producer-network-thread | producer-10] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-10] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:15 [kafka-producer-network-thread | producer-10] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-10] ProducerId set to 7014 with epoch 0
2025-04-12 10:58:15 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:15 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_97, value: {"_id": {"$oid": "67f10b97558ab0f6396b146b"}, "review": "Mediocre quality, nothing special.", "authId": "user_97", "datetime": "2025-01-28T15:08:57.912Z", "sentiment": null}, offset: 70359
2025-04-12 10:58:15 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_97
2025-04-12 10:58:16 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b146b"}, "review": "Mediocre quality, nothing special.", "authId": "user_97", "datetime": "2025-01-28T15:08:57.912Z", "sentiment": null}%n
2025-04-12 10:58:16 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:16 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:16 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-11
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:16 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:16 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-11] Instantiated an idempotent producer.
2025-04-12 10:58:16 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:16 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:16 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455496426
2025-04-12 10:58:16 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:16 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_97', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:16 [kafka-producer-network-thread | producer-11] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-11] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:16 [kafka-producer-network-thread | producer-11] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-11] ProducerId set to 7015 with epoch 0
2025-04-12 10:58:16 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:16 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_42, value: {"_id": {"$oid": "67f10b97558ab0f6396b1434"}, "review": "Poor build quality, not reliable.", "authId": "user_42", "datetime": "2025-01-19T04:11:26.866Z", "sentiment": null}, offset: 70360
2025-04-12 10:58:16 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_42
2025-04-12 10:58:16 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1434"}, "review": "Poor build quality, not reliable.", "authId": "user_42", "datetime": "2025-01-19T04:11:26.866Z", "sentiment": null}%n
2025-04-12 10:58:16 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:16 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:16 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-12
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:16 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:16 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-12] Instantiated an idempotent producer.
2025-04-12 10:58:16 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:16 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:16 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455496973
2025-04-12 10:58:16 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:16 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_42', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:16 [kafka-producer-network-thread | producer-12] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-12] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:16 [kafka-producer-network-thread | producer-12] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-12] ProducerId set to 7016 with epoch 0
2025-04-12 10:58:17 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:17 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_34, value: {"_id": {"$oid": "67f10b97558ab0f6396b142c"}, "review": "Waste of money, avoid at all costs.", "authId": "user_34", "datetime": "2025-01-22T04:27:11.909Z", "sentiment": null}, offset: 70361
2025-04-12 10:58:17 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_34
2025-04-12 10:58:18 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b142c"}, "review": "Waste of money, avoid at all costs.", "authId": "user_34", "datetime": "2025-01-22T04:27:11.909Z", "sentiment": null}%n
2025-04-12 10:58:18 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.5
score: -0.5

2025-04-12 10:58:18 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.5
score: -0.5

2025-04-12 10:58:18 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-13
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:18 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:18 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-13] Instantiated an idempotent producer.
2025-04-12 10:58:18 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:18 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:18 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455498617
2025-04-12 10:58:18 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:18 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_34', sentiment=magnitude: 0.5
score: -0.5
}
2025-04-12 10:58:18 [kafka-producer-network-thread | producer-13] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-13] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:18 [kafka-producer-network-thread | producer-13] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-13] ProducerId set to 7017 with epoch 0
2025-04-12 10:58:18 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:18 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_92, value: {"_id": {"$oid": "67f10b97558ab0f6396b1466"}, "review": "Horrible customer service.", "authId": "user_92", "datetime": "2025-02-16T16:39:31.912Z", "sentiment": null}, offset: 70362
2025-04-12 10:58:18 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_92
2025-04-12 10:58:19 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1466"}, "review": "Horrible customer service.", "authId": "user_92", "datetime": "2025-02-16T16:39:31.912Z", "sentiment": null}%n
2025-04-12 10:58:19 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.5
score: -0.5

2025-04-12 10:58:19 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.5
score: -0.5

2025-04-12 10:58:19 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-14
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:19 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:19 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-14] Instantiated an idempotent producer.
2025-04-12 10:58:19 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:19 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:19 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455499204
2025-04-12 10:58:19 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:19 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_92', sentiment=magnitude: 0.5
score: -0.5
}
2025-04-12 10:58:19 [kafka-producer-network-thread | producer-14] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-14] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:19 [kafka-producer-network-thread | producer-14] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-14] ProducerId set to 7018 with epoch 0
2025-04-12 10:58:19 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:19 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_64, value: {"_id": {"$oid": "67f10b97558ab0f6396b144a"}, "review": "Poor build quality, not reliable.", "authId": "user_64", "datetime": "2025-03-26T18:17:49.947Z", "sentiment": null}, offset: 70363
2025-04-12 10:58:19 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_64
2025-04-12 10:58:20 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b144a"}, "review": "Poor build quality, not reliable.", "authId": "user_64", "datetime": "2025-03-26T18:17:49.947Z", "sentiment": null}%n
2025-04-12 10:58:20 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:20 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:20 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-15
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:20 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:20 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-15] Instantiated an idempotent producer.
2025-04-12 10:58:20 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:20 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:20 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455500778
2025-04-12 10:58:20 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:20 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_64', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:20 [kafka-producer-network-thread | producer-15] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-15] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:20 [kafka-producer-network-thread | producer-15] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-15] ProducerId set to 7019 with epoch 0
2025-04-12 10:58:20 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:20 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_3, value: {"_id": {"$oid": "67f10b97558ab0f6396b140d"}, "review": "Fantastic performance and very durable.", "authId": "user_3", "datetime": "2025-02-25T04:22:40.515Z", "sentiment": null}, offset: 70364
2025-04-12 10:58:20 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_3
2025-04-12 10:58:21 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b140d"}, "review": "Fantastic performance and very durable.", "authId": "user_3", "datetime": "2025-02-25T04:22:40.515Z", "sentiment": null}%n
2025-04-12 10:58:21 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.3
score: 0.3

2025-04-12 10:58:21 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.3
score: 0.3

2025-04-12 10:58:21 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-16
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:21 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:21 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-16] Instantiated an idempotent producer.
2025-04-12 10:58:21 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:21 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:21 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455501333
2025-04-12 10:58:21 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:21 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_3', sentiment=magnitude: 0.3
score: 0.3
}
2025-04-12 10:58:21 [kafka-producer-network-thread | producer-16] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-16] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:21 [kafka-producer-network-thread | producer-16] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-16] ProducerId set to 7020 with epoch 0
2025-04-12 10:58:21 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:21 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_64, value: {"_id": {"$oid": "67f10b97558ab0f6396b144a"}, "review": "Poor build quality, not reliable.", "authId": "user_64", "datetime": "2025-03-26T18:17:49.947Z", "sentiment": null}, offset: 70365
2025-04-12 10:58:21 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_64
2025-04-12 10:58:21 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b144a"}, "review": "Poor build quality, not reliable.", "authId": "user_64", "datetime": "2025-03-26T18:17:49.947Z", "sentiment": null}%n
2025-04-12 10:58:21 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:21 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:21 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-17
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:21 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:21 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-17] Instantiated an idempotent producer.
2025-04-12 10:58:21 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:21 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:21 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455501909
2025-04-12 10:58:21 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:21 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_64', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:21 [kafka-producer-network-thread | producer-17] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-17] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:21 [kafka-producer-network-thread | producer-17] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-17] ProducerId set to 7021 with epoch 0
2025-04-12 10:58:21 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:21 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_56, value: {"_id": {"$oid": "67f10b97558ab0f6396b1442"}, "review": "It's okay, does the job.", "authId": "user_56", "datetime": "2024-12-14T20:56:35.004Z", "sentiment": null}, offset: 70366
2025-04-12 10:58:21 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_56
2025-04-12 10:58:22 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1442"}, "review": "It's okay, does the job.", "authId": "user_56", "datetime": "2024-12-14T20:56:35.004Z", "sentiment": null}%n
2025-04-12 10:58:22 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.3
score: -0.3

2025-04-12 10:58:22 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.3
score: -0.3

2025-04-12 10:58:22 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-18
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:22 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:22 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-18] Instantiated an idempotent producer.
2025-04-12 10:58:22 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:22 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:22 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455502506
2025-04-12 10:58:22 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:22 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_56', sentiment=magnitude: 0.3
score: -0.3
}
2025-04-12 10:58:22 [kafka-producer-network-thread | producer-18] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-18] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:22 [kafka-producer-network-thread | producer-18] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-18] ProducerId set to 7022 with epoch 0
2025-04-12 10:58:22 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:22 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_41, value: {"_id": {"$oid": "67f10b97558ab0f6396b1433"}, "review": "Mediocre quality, nothing special.", "authId": "user_41", "datetime": "2024-12-16T06:59:16.471Z", "sentiment": null}, offset: 70367
2025-04-12 10:58:22 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_41
2025-04-12 10:58:24 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1433"}, "review": "Mediocre quality, nothing special.", "authId": "user_41", "datetime": "2024-12-16T06:59:16.471Z", "sentiment": null}%n
2025-04-12 10:58:24 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:24 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:24 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-19
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:24 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:24 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-19] Instantiated an idempotent producer.
2025-04-12 10:58:24 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:24 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:24 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455504182
2025-04-12 10:58:24 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:24 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_41', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:24 [kafka-producer-network-thread | producer-19] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-19] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:24 [kafka-producer-network-thread | producer-19] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-19] ProducerId set to 7023 with epoch 0
2025-04-12 10:58:24 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:24 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_11, value: {"_id": {"$oid": "67f10b97558ab0f6396b1415"}, "review": "Would not recommend to anyone.", "authId": "user_11", "datetime": "2024-12-10T23:20:11.570Z", "sentiment": null}, offset: 70368
2025-04-12 10:58:24 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_11
2025-04-12 10:58:25 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1415"}, "review": "Would not recommend to anyone.", "authId": "user_11", "datetime": "2024-12-10T23:20:11.570Z", "sentiment": null}%n
2025-04-12 10:58:25 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:25 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:25 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-20
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:25 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:25 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-20] Instantiated an idempotent producer.
2025-04-12 10:58:25 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:25 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:25 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455505758
2025-04-12 10:58:25 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:25 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_11', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:25 [kafka-producer-network-thread | producer-20] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-20] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:25 [kafka-producer-network-thread | producer-20] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-20] ProducerId set to 7024 with epoch 0
2025-04-12 10:58:25 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:25 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_44, value: {"_id": {"$oid": "67f10b97558ab0f6396b1436"}, "review": "Not bad, not great either.", "authId": "user_44", "datetime": "2024-12-21T16:54:59.782Z", "sentiment": null}, offset: 70369
2025-04-12 10:58:25 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_44
2025-04-12 10:58:26 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1436"}, "review": "Not bad, not great either.", "authId": "user_44", "datetime": "2024-12-21T16:54:59.782Z", "sentiment": null}%n
2025-04-12 10:58:26 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.4
score: -0.4

2025-04-12 10:58:26 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.4
score: -0.4

2025-04-12 10:58:26 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-21
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:26 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:26 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-21] Instantiated an idempotent producer.
2025-04-12 10:58:26 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:26 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:26 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455506337
2025-04-12 10:58:26 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:26 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_44', sentiment=magnitude: 0.4
score: -0.4
}
2025-04-12 10:58:26 [kafka-producer-network-thread | producer-21] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-21] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:26 [kafka-producer-network-thread | producer-21] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-21] ProducerId set to 7025 with epoch 0
2025-04-12 10:58:26 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:26 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_66, value: {"_id": {"$oid": "67f10b97558ab0f6396b144c"}, "review": "Great quality, will buy again.", "authId": "user_66", "datetime": "2025-02-01T17:37:18.002Z", "sentiment": null}, offset: 70370
2025-04-12 10:58:26 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_66
2025-04-12 10:58:26 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b144c"}, "review": "Great quality, will buy again.", "authId": "user_66", "datetime": "2025-02-01T17:37:18.002Z", "sentiment": null}%n
2025-04-12 10:58:26 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.1
score: 0.1

2025-04-12 10:58:26 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.1
score: 0.1

2025-04-12 10:58:26 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-22
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:26 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:26 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-22] Instantiated an idempotent producer.
2025-04-12 10:58:26 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:26 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:26 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455506883
2025-04-12 10:58:26 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:26 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_66', sentiment=magnitude: 0.1
score: 0.1
}
2025-04-12 10:58:26 [kafka-producer-network-thread | producer-22] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-22] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:26 [kafka-producer-network-thread | producer-22] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-22] ProducerId set to 7026 with epoch 0
2025-04-12 10:58:26 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:26 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_90, value: {"_id": {"$oid": "67f10b97558ab0f6396b1464"}, "review": "This changed my life!", "authId": "user_90", "datetime": "2025-02-19T23:47:30.750Z", "sentiment": null}, offset: 70371
2025-04-12 10:58:26 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_90
2025-04-12 10:58:27 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1464"}, "review": "This changed my life!", "authId": "user_90", "datetime": "2025-02-19T23:47:30.750Z", "sentiment": null}%n
2025-04-12 10:58:27 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.1
score: -0.1

2025-04-12 10:58:27 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.1
score: -0.1

2025-04-12 10:58:27 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-23
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:27 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:27 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-23] Instantiated an idempotent producer.
2025-04-12 10:58:27 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:27 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:27 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455507495
2025-04-12 10:58:27 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:27 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_90', sentiment=magnitude: 0.1
score: -0.1
}
2025-04-12 10:58:27 [kafka-producer-network-thread | producer-23] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-23] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:27 [kafka-producer-network-thread | producer-23] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-23] ProducerId set to 7027 with epoch 0
2025-04-12 10:58:27 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:27 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_50, value: {"_id": {"$oid": "67f10b97558ab0f6396b143c"}, "review": "Works like a charm, perfect!", "authId": "user_50", "datetime": "2025-03-28T22:16:25.554Z", "sentiment": null}, offset: 70372
2025-04-12 10:58:27 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_50
2025-04-12 10:58:28 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b143c"}, "review": "Works like a charm, perfect!", "authId": "user_50", "datetime": "2025-03-28T22:16:25.554Z", "sentiment": null}%n
2025-04-12 10:58:28 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.2
score: 0.2

2025-04-12 10:58:28 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.2
score: 0.2

2025-04-12 10:58:28 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-24
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:28 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:28 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-24] Instantiated an idempotent producer.
2025-04-12 10:58:28 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:28 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:28 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455508089
2025-04-12 10:58:28 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:28 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_50', sentiment=magnitude: 0.2
score: 0.2
}
2025-04-12 10:58:28 [kafka-producer-network-thread | producer-24] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-24] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:28 [kafka-producer-network-thread | producer-24] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-24] ProducerId set to 7028 with epoch 0
2025-04-12 10:58:28 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:28 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_93, value: {"_id": {"$oid": "67f10b97558ab0f6396b1467"}, "review": "Doesn't work as advertised.", "authId": "user_93", "datetime": "2025-01-02T18:13:11.127Z", "sentiment": null}, offset: 70373
2025-04-12 10:58:28 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_93
2025-04-12 10:58:29 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1467"}, "review": "Doesn't work as advertised.", "authId": "user_93", "datetime": "2025-01-02T18:13:11.127Z", "sentiment": null}%n
2025-04-12 10:58:29 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:29 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:29 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-25
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:29 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:29 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-25] Instantiated an idempotent producer.
2025-04-12 10:58:29 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:29 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:29 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455509623
2025-04-12 10:58:29 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:29 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_93', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:29 [kafka-producer-network-thread | producer-25] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-25] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:29 [kafka-producer-network-thread | producer-25] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-25] ProducerId set to 7029 with epoch 0
2025-04-12 10:58:29 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:29 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_63, value: {"_id": {"$oid": "67f10b97558ab0f6396b1449"}, "review": "Fantastic performance and very durable.", "authId": "user_63", "datetime": "2025-02-03T10:12:02.742Z", "sentiment": null}, offset: 70374
2025-04-12 10:58:29 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_63
2025-04-12 10:58:31 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1449"}, "review": "Fantastic performance and very durable.", "authId": "user_63", "datetime": "2025-02-03T10:12:02.742Z", "sentiment": null}%n
2025-04-12 10:58:31 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.3
score: 0.3

2025-04-12 10:58:31 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.3
score: 0.3

2025-04-12 10:58:31 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-26
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:31 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:31 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-26] Instantiated an idempotent producer.
2025-04-12 10:58:31 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:31 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:31 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455511145
2025-04-12 10:58:31 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:31 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_63', sentiment=magnitude: 0.3
score: 0.3
}
2025-04-12 10:58:31 [kafka-producer-network-thread | producer-26] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-26] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:31 [kafka-producer-network-thread | producer-26] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-26] ProducerId set to 7030 with epoch 0
2025-04-12 10:58:31 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:31 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_34, value: {"_id": {"$oid": "67f10b97558ab0f6396b142c"}, "review": "Waste of money, avoid at all costs.", "authId": "user_34", "datetime": "2025-01-22T04:27:11.909Z", "sentiment": null}, offset: 70375
2025-04-12 10:58:31 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_34
2025-04-12 10:58:31 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b142c"}, "review": "Waste of money, avoid at all costs.", "authId": "user_34", "datetime": "2025-01-22T04:27:11.909Z", "sentiment": null}%n
2025-04-12 10:58:31 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.5
score: -0.5

2025-04-12 10:58:31 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.5
score: -0.5

2025-04-12 10:58:31 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-27
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:31 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:31 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-27] Instantiated an idempotent producer.
2025-04-12 10:58:31 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:31 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:31 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455511975
2025-04-12 10:58:31 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:31 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_34', sentiment=magnitude: 0.5
score: -0.5
}
2025-04-12 10:58:31 [kafka-producer-network-thread | producer-27] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-27] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:31 [kafka-producer-network-thread | producer-27] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-27] ProducerId set to 7031 with epoch 0
2025-04-12 10:58:31 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:31 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_98, value: {"_id": {"$oid": "67f10b97558ab0f6396b146c"}, "review": "Not bad, not great either.", "authId": "user_98", "datetime": "2025-03-21T23:54:21.817Z", "sentiment": null}, offset: 70376
2025-04-12 10:58:31 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_98
2025-04-12 10:58:32 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b146c"}, "review": "Not bad, not great either.", "authId": "user_98", "datetime": "2025-03-21T23:54:21.817Z", "sentiment": null}%n
2025-04-12 10:58:32 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.4
score: -0.4

2025-04-12 10:58:32 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.4
score: -0.4

2025-04-12 10:58:32 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-28
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:32 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:32 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-28] Instantiated an idempotent producer.
2025-04-12 10:58:32 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:32 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:32 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455512544
2025-04-12 10:58:32 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:32 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_98', sentiment=magnitude: 0.4
score: -0.4
}
2025-04-12 10:58:32 [kafka-producer-network-thread | producer-28] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-28] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:32 [kafka-producer-network-thread | producer-28] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-28] ProducerId set to 7032 with epoch 0
2025-04-12 10:58:32 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:32 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_64, value: {"_id": {"$oid": "67f10b97558ab0f6396b144a"}, "review": "Poor build quality, not reliable.", "authId": "user_64", "datetime": "2025-03-26T18:17:49.947Z", "sentiment": null}, offset: 70377
2025-04-12 10:58:32 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_64
2025-04-12 10:58:33 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b144a"}, "review": "Poor build quality, not reliable.", "authId": "user_64", "datetime": "2025-03-26T18:17:49.947Z", "sentiment": null}%n
2025-04-12 10:58:33 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:33 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:33 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-29
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:33 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:33 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-29] Instantiated an idempotent producer.
2025-04-12 10:58:33 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:33 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:33 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455513104
2025-04-12 10:58:33 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:33 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_64', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:33 [kafka-producer-network-thread | producer-29] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-29] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:33 [kafka-producer-network-thread | producer-29] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-29] ProducerId set to 7033 with epoch 0
2025-04-12 10:58:33 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:33 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_37, value: {"_id": {"$oid": "67f10b97558ab0f6396b142f"}, "review": "Mediocre quality, nothing special.", "authId": "user_37", "datetime": "2024-12-22T11:29:54.974Z", "sentiment": null}, offset: 70378
2025-04-12 10:58:33 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_37
2025-04-12 10:58:33 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b142f"}, "review": "Mediocre quality, nothing special.", "authId": "user_37", "datetime": "2024-12-22T11:29:54.974Z", "sentiment": null}%n
2025-04-12 10:58:33 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:33 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:33 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-30
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:33 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:33 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-30] Instantiated an idempotent producer.
2025-04-12 10:58:33 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:33 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:33 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455513667
2025-04-12 10:58:33 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:33 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_37', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:33 [kafka-producer-network-thread | producer-30] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-30] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:33 [kafka-producer-network-thread | producer-30] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-30] ProducerId set to 7034 with epoch 0
2025-04-12 10:58:33 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:33 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_32, value: {"_id": {"$oid": "67f10b97558ab0f6396b142a"}, "review": "Fantastic performance and very durable.", "authId": "user_32", "datetime": "2025-01-03T02:26:59.600Z", "sentiment": null}, offset: 70379
2025-04-12 10:58:33 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_32
2025-04-12 10:58:34 [Thread-6] INFO  o.s.t.kafka.consumer.ConsumerManager - Shutting down consumers...
2025-04-12 10:58:35 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b142a"}, "review": "Fantastic performance and very durable.", "authId": "user_32", "datetime": "2025-01-03T02:26:59.600Z", "sentiment": null}%n
2025-04-12 10:58:35 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.3
score: 0.3

2025-04-12 10:58:35 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.3
score: 0.3

2025-04-12 10:58:35 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-31
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:35 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:35 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-31] Instantiated an idempotent producer.
2025-04-12 10:58:35 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:35 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:35 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455515311
2025-04-12 10:58:35 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:35 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_32', sentiment=magnitude: 0.3
score: 0.3
}
2025-04-12 10:58:35 [kafka-producer-network-thread | producer-31] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-31] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:35 [kafka-producer-network-thread | producer-31] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-31] ProducerId set to 7035 with epoch 0
2025-04-12 10:58:35 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:35 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_93, value: {"_id": {"$oid": "67f10b97558ab0f6396b1467"}, "review": "Doesn't work as advertised.", "authId": "user_93", "datetime": "2025-01-02T18:13:11.127Z", "sentiment": null}, offset: 70380
2025-04-12 10:58:35 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_93
2025-04-12 10:58:35 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:35 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:35 [Worker-2] ERROR o.s.t.k.consumer.ConsumerTemplate - Error removing shutdown hook
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.remove(ApplicationShutdownHooks.java:83)
	at java.base/java.lang.Runtime.removeShutdownHook(Runtime.java:281)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.cleanup(ConsumerTemplate.java:141)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:90)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:35 [Worker-2] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-2, groupId=contacts-test-group] Member consumer-contacts-test-group-2-9edd3811-cff6-4a0e-9c34-e8f857068d9f sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer is being closed
2025-04-12 10:58:35 [Worker-2] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-2, groupId=contacts-test-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-04-12 10:58:35 [Worker-2] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-2, groupId=contacts-test-group] Request joining group due to: consumer pro-actively leaving the group
2025-04-12 10:58:35 [Worker-2] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-04-12 10:58:35 [Worker-2] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-04-12 10:58:35 [Worker-2] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-04-12 10:58:35 [Worker-2] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-04-12 10:58:35 [Worker-2] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-contacts-test-group-2 unregistered
2025-04-12 10:58:35 [Worker-2] INFO  o.s.t.k.consumer.ConsumerTemplate - Kafka consumer closed.
2025-04-12 10:58:35 [Worker-3] ERROR o.s.t.k.consumer.ConsumerTemplate - Error removing shutdown hook
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.remove(ApplicationShutdownHooks.java:83)
	at java.base/java.lang.Runtime.removeShutdownHook(Runtime.java:281)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.cleanup(ConsumerTemplate.java:141)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:90)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:35 [Worker-3] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-3, groupId=contacts-test-group] Member consumer-contacts-test-group-3-e98420c2-1527-4395-b038-46e9d93a736c sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer is being closed
2025-04-12 10:58:35 [Worker-3] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-3, groupId=contacts-test-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-04-12 10:58:35 [Worker-3] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-3, groupId=contacts-test-group] Request joining group due to: consumer pro-actively leaving the group
2025-04-12 10:58:35 [Worker-3] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-04-12 10:58:35 [Worker-3] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-04-12 10:58:35 [Worker-3] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-04-12 10:58:35 [Worker-3] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-04-12 10:58:35 [Worker-3] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-contacts-test-group-3 unregistered
2025-04-12 10:58:35 [Worker-4] ERROR o.s.t.k.consumer.ConsumerTemplate - Error removing shutdown hook
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.remove(ApplicationShutdownHooks.java:83)
	at java.base/java.lang.Runtime.removeShutdownHook(Runtime.java:281)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.cleanup(ConsumerTemplate.java:141)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:90)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:35 [Worker-3] INFO  o.s.t.k.consumer.ConsumerTemplate - Kafka consumer closed.
2025-04-12 10:58:35 [Worker-4] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-4, groupId=contacts-test-group] Member consumer-contacts-test-group-4-eb8eccd9-73bb-4a33-b0d1-b7493d87a345 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer is being closed
2025-04-12 10:58:35 [Worker-4] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-4, groupId=contacts-test-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-04-12 10:58:35 [Worker-4] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-4, groupId=contacts-test-group] Request joining group due to: consumer pro-actively leaving the group
2025-04-12 10:58:35 [Worker-4] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-04-12 10:58:35 [Worker-4] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-04-12 10:58:35 [Worker-4] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-04-12 10:58:35 [Worker-4] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-04-12 10:58:35 [Worker-4] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-contacts-test-group-4 unregistered
2025-04-12 10:58:35 [Worker-4] INFO  o.s.t.k.consumer.ConsumerTemplate - Kafka consumer closed.
2025-04-12 10:58:35 [Worker-5] ERROR o.s.t.k.consumer.ConsumerTemplate - Error removing shutdown hook
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.remove(ApplicationShutdownHooks.java:83)
	at java.base/java.lang.Runtime.removeShutdownHook(Runtime.java:281)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.cleanup(ConsumerTemplate.java:141)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:90)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:35 [Worker-5] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-5, groupId=contacts-test-group] Member consumer-contacts-test-group-5-f6a3bbbe-b884-417b-bbec-854f46512913 sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer is being closed
2025-04-12 10:58:35 [Worker-5] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-5, groupId=contacts-test-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-04-12 10:58:35 [Worker-5] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-5, groupId=contacts-test-group] Request joining group due to: consumer pro-actively leaving the group
2025-04-12 10:58:35 [Worker-5] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-04-12 10:58:35 [Worker-5] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-04-12 10:58:35 [Worker-5] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-04-12 10:58:35 [Worker-5] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-04-12 10:58:35 [Worker-5] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-contacts-test-group-5 unregistered
2025-04-12 10:58:35 [Worker-5] INFO  o.s.t.k.consumer.ConsumerTemplate - Kafka consumer closed.
2025-04-12 10:58:35 [Worker-6] ERROR o.s.t.k.consumer.ConsumerTemplate - Error removing shutdown hook
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.remove(ApplicationShutdownHooks.java:83)
	at java.base/java.lang.Runtime.removeShutdownHook(Runtime.java:281)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.cleanup(ConsumerTemplate.java:141)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:90)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:35 [Worker-6] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-6, groupId=contacts-test-group] Member consumer-contacts-test-group-6-a1cae8df-6e08-4489-b7b8-5758c7d0d90d sending LeaveGroup request to coordinator localhost:9092 (id: 2147483646 rack: null) due to the consumer is being closed
2025-04-12 10:58:35 [Worker-6] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-6, groupId=contacts-test-group] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-04-12 10:58:35 [Worker-6] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-6, groupId=contacts-test-group] Request joining group due to: consumer pro-actively leaving the group
2025-04-12 10:58:35 [Worker-6] INFO  o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-04-12 10:58:35 [Worker-6] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-04-12 10:58:35 [Worker-6] INFO  o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-04-12 10:58:35 [Worker-6] INFO  o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-04-12 10:58:35 [Worker-6] INFO  o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-contacts-test-group-6 unregistered
2025-04-12 10:58:35 [Worker-6] INFO  o.s.t.k.consumer.ConsumerTemplate - Kafka consumer closed.
2025-04-12 10:58:35 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1467"}, "review": "Doesn't work as advertised.", "authId": "user_93", "datetime": "2025-01-02T18:13:11.127Z", "sentiment": null}%n
2025-04-12 10:58:35 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:35 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:35 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-32
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:35 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:35 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-32] Instantiated an idempotent producer.
2025-04-12 10:58:35 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:35 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:35 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455515926
2025-04-12 10:58:35 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:35 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_93', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:35 [kafka-producer-network-thread | producer-32] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-32] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:35 [kafka-producer-network-thread | producer-32] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-32] ProducerId set to 7036 with epoch 0
2025-04-12 10:58:35 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:35 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_67, value: {"_id": {"$oid": "67f10b97558ab0f6396b144d"}, "review": "Works like a charm, perfect!", "authId": "user_67", "datetime": "2025-02-10T15:03:00.523Z", "sentiment": null}, offset: 70381
2025-04-12 10:58:35 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_67
2025-04-12 10:58:35 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:35 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:37 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b144d"}, "review": "Works like a charm, perfect!", "authId": "user_67", "datetime": "2025-02-10T15:03:00.523Z", "sentiment": null}%n
2025-04-12 10:58:37 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.3
score: 0.3

2025-04-12 10:58:37 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.3
score: 0.3

2025-04-12 10:58:37 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-33
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:37 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:37 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-33] Instantiated an idempotent producer.
2025-04-12 10:58:37 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:37 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:37 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455517457
2025-04-12 10:58:37 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:37 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_67', sentiment=magnitude: 0.3
score: 0.3
}
2025-04-12 10:58:37 [kafka-producer-network-thread | producer-33] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-33] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:37 [kafka-producer-network-thread | producer-33] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-33] ProducerId set to 7037 with epoch 0
2025-04-12 10:58:37 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:37 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_79, value: {"_id": {"$oid": "67f10b97558ab0f6396b1459"}, "review": "Very bad quality, feels cheap.", "authId": "user_79", "datetime": "2025-01-19T05:55:16.222Z", "sentiment": null}, offset: 70382
2025-04-12 10:58:37 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_79
2025-04-12 10:58:37 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:37 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:37 [kafka-coordinator-heartbeat-thread | contacts-test-group] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-1, groupId=contacts-test-group] Request joining group due to: group is already rebalancing
2025-04-12 10:58:37 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1459"}, "review": "Very bad quality, feels cheap.", "authId": "user_79", "datetime": "2025-01-19T05:55:16.222Z", "sentiment": null}%n
2025-04-12 10:58:38 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:38 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:38 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-34
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:38 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:38 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-34] Instantiated an idempotent producer.
2025-04-12 10:58:38 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:38 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:38 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455518017
2025-04-12 10:58:38 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:38 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_79', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:38 [kafka-producer-network-thread | producer-34] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-34] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:38 [kafka-producer-network-thread | producer-34] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-34] ProducerId set to 7038 with epoch 0
2025-04-12 10:58:38 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:38 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_82, value: {"_id": {"$oid": "67f10b97558ab0f6396b145c"}, "review": "Doesn't work as advertised.", "authId": "user_82", "datetime": "2025-03-31T12:18:06.328Z", "sentiment": null}, offset: 70383
2025-04-12 10:58:38 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_82
2025-04-12 10:58:38 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:38 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:39 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b145c"}, "review": "Doesn't work as advertised.", "authId": "user_82", "datetime": "2025-03-31T12:18:06.328Z", "sentiment": null}%n
2025-04-12 10:58:39 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:39 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:39 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-35
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:39 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:39 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-35] Instantiated an idempotent producer.
2025-04-12 10:58:39 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:39 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:39 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455519547
2025-04-12 10:58:39 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:39 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_82', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:39 [kafka-producer-network-thread | producer-35] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-35] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:39 [kafka-producer-network-thread | producer-35] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-35] ProducerId set to 7039 with epoch 0
2025-04-12 10:58:39 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:39 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_44, value: {"_id": {"$oid": "67f10b97558ab0f6396b1436"}, "review": "Not bad, not great either.", "authId": "user_44", "datetime": "2024-12-21T16:54:59.782Z", "sentiment": null}, offset: 70384
2025-04-12 10:58:39 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_44
2025-04-12 10:58:39 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:39 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:40 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1436"}, "review": "Not bad, not great either.", "authId": "user_44", "datetime": "2024-12-21T16:54:59.782Z", "sentiment": null}%n
2025-04-12 10:58:40 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.4
score: -0.4

2025-04-12 10:58:40 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.4
score: -0.4

2025-04-12 10:58:40 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-36
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:40 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:40 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-36] Instantiated an idempotent producer.
2025-04-12 10:58:40 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:40 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:40 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455520077
2025-04-12 10:58:40 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:40 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_44', sentiment=magnitude: 0.4
score: -0.4
}
2025-04-12 10:58:40 [kafka-producer-network-thread | producer-36] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-36] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:40 [kafka-producer-network-thread | producer-36] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-36] ProducerId set to 7040 with epoch 0
2025-04-12 10:58:40 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:40 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_79, value: {"_id": {"$oid": "67f10b97558ab0f6396b1459"}, "review": "Very bad quality, feels cheap.", "authId": "user_79", "datetime": "2025-01-19T05:55:16.222Z", "sentiment": null}, offset: 70385
2025-04-12 10:58:40 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_79
2025-04-12 10:58:40 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:40 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:40 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1459"}, "review": "Very bad quality, feels cheap.", "authId": "user_79", "datetime": "2025-01-19T05:55:16.222Z", "sentiment": null}%n
2025-04-12 10:58:40 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:40 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:40 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-37
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:40 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:40 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-37] Instantiated an idempotent producer.
2025-04-12 10:58:40 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:40 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:40 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455520627
2025-04-12 10:58:40 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:40 [kafka-producer-network-thread | producer-37] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-37] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:40 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_79', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:40 [kafka-producer-network-thread | producer-37] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-37] ProducerId set to 7041 with epoch 0
2025-04-12 10:58:40 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:40 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_89, value: {"_id": {"$oid": "67f10b97558ab0f6396b1463"}, "review": "It broke after a week of use.", "authId": "user_89", "datetime": "2025-01-07T07:29:12.974Z", "sentiment": null}, offset: 70386
2025-04-12 10:58:40 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_89
2025-04-12 10:58:40 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:40 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:40 [kafka-coordinator-heartbeat-thread | contacts-test-group] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-1, groupId=contacts-test-group] Request joining group due to: group is already rebalancing
2025-04-12 10:58:41 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1463"}, "review": "It broke after a week of use.", "authId": "user_89", "datetime": "2025-01-07T07:29:12.974Z", "sentiment": null}%n
2025-04-12 10:58:41 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.6
score: -0.6

2025-04-12 10:58:41 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.6
score: -0.6

2025-04-12 10:58:41 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-38
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:41 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:41 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-38] Instantiated an idempotent producer.
2025-04-12 10:58:41 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:41 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:41 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455521307
2025-04-12 10:58:41 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:41 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_89', sentiment=magnitude: 0.6
score: -0.6
}
2025-04-12 10:58:41 [kafka-producer-network-thread | producer-38] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-38] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:41 [kafka-producer-network-thread | producer-38] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-38] ProducerId set to 7042 with epoch 0
2025-04-12 10:58:41 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:41 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_82, value: {"_id": {"$oid": "67f10b97558ab0f6396b145c"}, "review": "Doesn't work as advertised.", "authId": "user_82", "datetime": "2025-03-31T12:18:06.328Z", "sentiment": null}, offset: 70387
2025-04-12 10:58:41 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_82
2025-04-12 10:58:41 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:41 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:41 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b145c"}, "review": "Doesn't work as advertised.", "authId": "user_82", "datetime": "2025-03-31T12:18:06.328Z", "sentiment": null}%n
2025-04-12 10:58:41 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:41 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:41 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-39
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:41 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:41 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-39] Instantiated an idempotent producer.
2025-04-12 10:58:41 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:41 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:41 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455521884
2025-04-12 10:58:41 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:41 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_82', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:41 [kafka-producer-network-thread | producer-39] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-39] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:41 [kafka-producer-network-thread | producer-39] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-39] ProducerId set to 7043 with epoch 0
2025-04-12 10:58:41 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:41 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_63, value: {"_id": {"$oid": "67f10b97558ab0f6396b1449"}, "review": "Fantastic performance and very durable.", "authId": "user_63", "datetime": "2025-02-03T10:12:02.742Z", "sentiment": null}, offset: 70388
2025-04-12 10:58:41 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_63
2025-04-12 10:58:41 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:41 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:42 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1449"}, "review": "Fantastic performance and very durable.", "authId": "user_63", "datetime": "2025-02-03T10:12:02.742Z", "sentiment": null}%n
2025-04-12 10:58:42 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.3
score: 0.3

2025-04-12 10:58:42 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.3
score: 0.3

2025-04-12 10:58:42 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-40
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:42 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:42 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-40] Instantiated an idempotent producer.
2025-04-12 10:58:42 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:42 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:42 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455522428
2025-04-12 10:58:42 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:42 [kafka-producer-network-thread | producer-40] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-40] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:42 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_63', sentiment=magnitude: 0.3
score: 0.3
}
2025-04-12 10:58:42 [kafka-producer-network-thread | producer-40] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-40] ProducerId set to 7044 with epoch 0
2025-04-12 10:58:42 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:42 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_57, value: {"_id": {"$oid": "67f10b97558ab0f6396b1443"}, "review": "This changed my life!", "authId": "user_57", "datetime": "2025-03-21T00:28:58.918Z", "sentiment": null}, offset: 70389
2025-04-12 10:58:42 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_57
2025-04-12 10:58:42 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:42 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:42 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1443"}, "review": "This changed my life!", "authId": "user_57", "datetime": "2025-03-21T00:28:58.918Z", "sentiment": null}%n
2025-04-12 10:58:42 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.2
score: -0.2

2025-04-12 10:58:42 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.2
score: -0.2

2025-04-12 10:58:42 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-41
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:42 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:42 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-41] Instantiated an idempotent producer.
2025-04-12 10:58:42 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:42 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:42 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455522984
2025-04-12 10:58:42 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:42 [kafka-producer-network-thread | producer-41] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-41] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:42 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_57', sentiment=magnitude: 0.2
score: -0.2
}
2025-04-12 10:58:42 [kafka-producer-network-thread | producer-41] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-41] ProducerId set to 7045 with epoch 0
2025-04-12 10:58:43 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:43 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_57, value: {"_id": {"$oid": "67f10b97558ab0f6396b1443"}, "review": "This changed my life!", "authId": "user_57", "datetime": "2025-03-21T00:28:58.918Z", "sentiment": null}, offset: 70390
2025-04-12 10:58:43 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_57
2025-04-12 10:58:43 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:43 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:43 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1443"}, "review": "This changed my life!", "authId": "user_57", "datetime": "2025-03-21T00:28:58.918Z", "sentiment": null}%n
2025-04-12 10:58:43 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.2
score: -0.2

2025-04-12 10:58:43 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.2
score: -0.2

2025-04-12 10:58:43 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-42
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:43 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:43 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-42] Instantiated an idempotent producer.
2025-04-12 10:58:43 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:43 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:43 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455523541
2025-04-12 10:58:43 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:43 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_57', sentiment=magnitude: 0.2
score: -0.2
}
2025-04-12 10:58:43 [kafka-producer-network-thread | producer-42] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-42] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:43 [kafka-producer-network-thread | producer-42] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-42] ProducerId set to 7046 with epoch 0
2025-04-12 10:58:43 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:43 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_69, value: {"_id": {"$oid": "67f10b97558ab0f6396b144f"}, "review": "Decent, but not amazing.", "authId": "user_69", "datetime": "2024-12-28T22:45:48.069Z", "sentiment": null}, offset: 70391
2025-04-12 10:58:43 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_69
2025-04-12 10:58:43 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:43 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:43 [kafka-coordinator-heartbeat-thread | contacts-test-group] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-1, groupId=contacts-test-group] Request joining group due to: group is already rebalancing
2025-04-12 10:58:44 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b144f"}, "review": "Decent, but not amazing.", "authId": "user_69", "datetime": "2024-12-28T22:45:48.069Z", "sentiment": null}%n
2025-04-12 10:58:44 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.4
score: -0.4

2025-04-12 10:58:44 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.4
score: -0.4

2025-04-12 10:58:44 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-43
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:44 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:44 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-43] Instantiated an idempotent producer.
2025-04-12 10:58:44 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:44 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:44 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455524129
2025-04-12 10:58:44 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:44 [kafka-producer-network-thread | producer-43] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-43] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:44 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_69', sentiment=magnitude: 0.4
score: -0.4
}
2025-04-12 10:58:44 [kafka-producer-network-thread | producer-43] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-43] ProducerId set to 7047 with epoch 0
2025-04-12 10:58:44 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:44 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_47, value: {"_id": {"$oid": "67f10b97558ab0f6396b1439"}, "review": "Top-notch! Will definitely recommend.", "authId": "user_47", "datetime": "2025-01-08T17:35:19.231Z", "sentiment": null}, offset: 70392
2025-04-12 10:58:44 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_47
2025-04-12 10:58:44 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:44 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:45 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1439"}, "review": "Top-notch! Will definitely recommend.", "authId": "user_47", "datetime": "2025-01-08T17:35:19.231Z", "sentiment": null}%n
2025-04-12 10:58:45 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.8
score: 0.4

2025-04-12 10:58:45 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.8
score: 0.4

2025-04-12 10:58:45 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-44
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:45 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:45 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-44] Instantiated an idempotent producer.
2025-04-12 10:58:45 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:45 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:45 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455525675
2025-04-12 10:58:45 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:45 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_47', sentiment=magnitude: 0.8
score: 0.4
}
2025-04-12 10:58:45 [kafka-producer-network-thread | producer-44] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-44] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:45 [kafka-producer-network-thread | producer-44] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-44] ProducerId set to 7048 with epoch 0
2025-04-12 10:58:45 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:45 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_59, value: {"_id": {"$oid": "67f10b97558ab0f6396b1445"}, "review": "It's okay, does the job.", "authId": "user_59", "datetime": "2024-12-03T13:32:51.362Z", "sentiment": null}, offset: 70393
2025-04-12 10:58:45 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_59
2025-04-12 10:58:45 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:45 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:46 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1445"}, "review": "It's okay, does the job.", "authId": "user_59", "datetime": "2024-12-03T13:32:51.362Z", "sentiment": null}%n
2025-04-12 10:58:46 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.3
score: -0.3

2025-04-12 10:58:46 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.3
score: -0.3

2025-04-12 10:58:46 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-45
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:46 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:46 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-45] Instantiated an idempotent producer.
2025-04-12 10:58:46 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:46 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:46 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455526364
2025-04-12 10:58:46 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:46 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_59', sentiment=magnitude: 0.3
score: -0.3
}
2025-04-12 10:58:46 [kafka-producer-network-thread | producer-45] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-45] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:46 [kafka-producer-network-thread | producer-45] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-45] ProducerId set to 7049 with epoch 0
2025-04-12 10:58:46 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:46 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_93, value: {"_id": {"$oid": "67f10b97558ab0f6396b1467"}, "review": "Doesn't work as advertised.", "authId": "user_93", "datetime": "2025-01-02T18:13:11.127Z", "sentiment": null}, offset: 70394
2025-04-12 10:58:46 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_93
2025-04-12 10:58:46 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:46 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:46 [kafka-coordinator-heartbeat-thread | contacts-test-group] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-1, groupId=contacts-test-group] Request joining group due to: group is already rebalancing
2025-04-12 10:58:46 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1467"}, "review": "Doesn't work as advertised.", "authId": "user_93", "datetime": "2025-01-02T18:13:11.127Z", "sentiment": null}%n
2025-04-12 10:58:46 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:46 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:46 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-46
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:46 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:46 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-46] Instantiated an idempotent producer.
2025-04-12 10:58:46 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:46 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:46 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455526947
2025-04-12 10:58:46 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:46 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_93', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:46 [kafka-producer-network-thread | producer-46] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-46] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:46 [kafka-producer-network-thread | producer-46] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-46] ProducerId set to 7050 with epoch 0
2025-04-12 10:58:46 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:46 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_36, value: {"_id": {"$oid": "67f10b97558ab0f6396b142e"}, "review": "Works like a charm, perfect!", "authId": "user_36", "datetime": "2024-12-07T01:28:05.981Z", "sentiment": null}, offset: 70395
2025-04-12 10:58:46 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_36
2025-04-12 10:58:46 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:46 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:47 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b142e"}, "review": "Works like a charm, perfect!", "authId": "user_36", "datetime": "2024-12-07T01:28:05.981Z", "sentiment": null}%n
2025-04-12 10:58:47 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.2
score: 0.2

2025-04-12 10:58:47 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.2
score: 0.2

2025-04-12 10:58:47 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-47
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:47 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:47 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-47] Instantiated an idempotent producer.
2025-04-12 10:58:47 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:47 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:47 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455527512
2025-04-12 10:58:47 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:47 [kafka-producer-network-thread | producer-47] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-47] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:47 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_36', sentiment=magnitude: 0.2
score: 0.2
}
2025-04-12 10:58:47 [kafka-producer-network-thread | producer-47] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-47] ProducerId set to 7051 with epoch 0
2025-04-12 10:58:47 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:47 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_99, value: {"_id": {"$oid": "67f10b97558ab0f6396b146d"}, "review": "Top-notch! Will definitely recommend.", "authId": "user_99", "datetime": "2025-04-01T13:25:28.546Z", "sentiment": null}, offset: 70396
2025-04-12 10:58:47 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_99
2025-04-12 10:58:47 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:47 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:48 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b146d"}, "review": "Top-notch! Will definitely recommend.", "authId": "user_99", "datetime": "2025-04-01T13:25:28.546Z", "sentiment": null}%n
2025-04-12 10:58:48 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.9
score: 0.4

2025-04-12 10:58:48 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.9
score: 0.4

2025-04-12 10:58:48 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-48
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:48 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:48 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-48] Instantiated an idempotent producer.
2025-04-12 10:58:48 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:48 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:48 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455528094
2025-04-12 10:58:48 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:48 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_99', sentiment=magnitude: 0.9
score: 0.4
}
2025-04-12 10:58:48 [kafka-producer-network-thread | producer-48] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-48] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:48 [kafka-producer-network-thread | producer-48] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-48] ProducerId set to 7052 with epoch 0
2025-04-12 10:58:48 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:48 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_17, value: {"_id": {"$oid": "67f10b97558ab0f6396b141b"}, "review": "Terrible experience, very disappointed.", "authId": "user_17", "datetime": "2025-03-01T00:30:53.030Z", "sentiment": null}, offset: 70397
2025-04-12 10:58:48 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_17
2025-04-12 10:58:48 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:48 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:48 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b141b"}, "review": "Terrible experience, very disappointed.", "authId": "user_17", "datetime": "2025-03-01T00:30:53.030Z", "sentiment": null}%n
2025-04-12 10:58:48 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:48 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:48 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-49
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:48 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:48 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-49] Instantiated an idempotent producer.
2025-04-12 10:58:48 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:48 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:48 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455528647
2025-04-12 10:58:48 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:48 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_17', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:48 [kafka-producer-network-thread | producer-49] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-49] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:48 [kafka-producer-network-thread | producer-49] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-49] ProducerId set to 7053 with epoch 0
2025-04-12 10:58:48 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:48 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_48, value: {"_id": {"$oid": "67f10b97558ab0f6396b143a"}, "review": "Terrible experience, very disappointed.", "authId": "user_48", "datetime": "2025-01-15T02:57:46.191Z", "sentiment": null}, offset: 70398
2025-04-12 10:58:48 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_48
2025-04-12 10:58:48 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:48 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:49 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b143a"}, "review": "Terrible experience, very disappointed.", "authId": "user_48", "datetime": "2025-01-15T02:57:46.191Z", "sentiment": null}%n
2025-04-12 10:58:49 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:49 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:49 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-50
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:49 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:49 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-50] Instantiated an idempotent producer.
2025-04-12 10:58:49 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:49 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:49 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455529185
2025-04-12 10:58:49 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:49 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_48', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:49 [kafka-producer-network-thread | producer-50] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-50] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:49 [kafka-producer-network-thread | producer-50] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-50] ProducerId set to 7054 with epoch 0
2025-04-12 10:58:49 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:49 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_18, value: {"_id": {"$oid": "67f10b97558ab0f6396b141c"}, "review": "Doesn't work as advertised.", "authId": "user_18", "datetime": "2025-02-20T09:53:18.980Z", "sentiment": null}, offset: 70399
2025-04-12 10:58:49 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_18
2025-04-12 10:58:49 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:49 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:49 [kafka-coordinator-heartbeat-thread | contacts-test-group] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-1, groupId=contacts-test-group] Request joining group due to: group is already rebalancing
2025-04-12 10:58:50 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b141c"}, "review": "Doesn't work as advertised.", "authId": "user_18", "datetime": "2025-02-20T09:53:18.980Z", "sentiment": null}%n
2025-04-12 10:58:50 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:50 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:50 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-51
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:50 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:50 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-51] Instantiated an idempotent producer.
2025-04-12 10:58:50 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:50 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:50 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455530770
2025-04-12 10:58:50 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:50 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_18', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:50 [kafka-producer-network-thread | producer-51] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-51] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:50 [kafka-producer-network-thread | producer-51] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-51] ProducerId set to 7055 with epoch 0
2025-04-12 10:58:50 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:50 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_2, value: {"_id": {"$oid": "67f10b97558ab0f6396b140c"}, "review": "Top-notch! Will definitely recommend.", "authId": "user_2", "datetime": "2025-02-16T12:22:32.981Z", "sentiment": null}, offset: 70400
2025-04-12 10:58:50 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_2
2025-04-12 10:58:50 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:50 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:51 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b140c"}, "review": "Top-notch! Will definitely recommend.", "authId": "user_2", "datetime": "2025-02-16T12:22:32.981Z", "sentiment": null}%n
2025-04-12 10:58:51 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.9
score: 0.4

2025-04-12 10:58:51 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.9
score: 0.4

2025-04-12 10:58:51 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-52
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:51 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:51 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-52] Instantiated an idempotent producer.
2025-04-12 10:58:51 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:51 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:51 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455531382
2025-04-12 10:58:51 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:51 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_2', sentiment=magnitude: 0.9
score: 0.4
}
2025-04-12 10:58:51 [kafka-producer-network-thread | producer-52] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-52] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:51 [kafka-producer-network-thread | producer-52] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-52] ProducerId set to 7056 with epoch 0
2025-04-12 10:58:51 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:51 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_86, value: {"_id": {"$oid": "67f10b97558ab0f6396b1460"}, "review": "Smooth and easy to use.", "authId": "user_86", "datetime": "2025-02-22T20:30:11.182Z", "sentiment": null}, offset: 70401
2025-04-12 10:58:51 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_86
2025-04-12 10:58:51 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:51 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:51 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1460"}, "review": "Smooth and easy to use.", "authId": "user_86", "datetime": "2025-02-22T20:30:11.182Z", "sentiment": null}%n
2025-04-12 10:58:51 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = 
2025-04-12 10:58:51 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data 
2025-04-12 10:58:51 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-53
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:51 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:51 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-53] Instantiated an idempotent producer.
2025-04-12 10:58:51 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:51 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:51 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455531937
2025-04-12 10:58:51 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:51 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_86', sentiment=}
2025-04-12 10:58:51 [kafka-producer-network-thread | producer-53] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-53] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:51 [kafka-producer-network-thread | producer-53] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-53] ProducerId set to 7057 with epoch 0
2025-04-12 10:58:51 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:51 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_65, value: {"_id": {"$oid": "67f10b97558ab0f6396b144b"}, "review": "Horrible customer service.", "authId": "user_65", "datetime": "2025-01-22T00:39:23.653Z", "sentiment": null}, offset: 70402
2025-04-12 10:58:51 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_65
2025-04-12 10:58:51 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:51 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:52 [kafka-coordinator-heartbeat-thread | contacts-test-group] INFO  o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-contacts-test-group-1, groupId=contacts-test-group] Request joining group due to: group is already rebalancing
2025-04-12 10:58:53 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b144b"}, "review": "Horrible customer service.", "authId": "user_65", "datetime": "2025-01-22T00:39:23.653Z", "sentiment": null}%n
2025-04-12 10:58:53 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.5
score: -0.5

2025-04-12 10:58:53 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.5
score: -0.5

2025-04-12 10:58:53 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-54
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:53 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:53 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-54] Instantiated an idempotent producer.
2025-04-12 10:58:53 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:53 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:53 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455533543
2025-04-12 10:58:53 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:53 [kafka-producer-network-thread | producer-54] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-54] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:53 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_65', sentiment=magnitude: 0.5
score: -0.5
}
2025-04-12 10:58:53 [kafka-producer-network-thread | producer-54] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-54] ProducerId set to 7058 with epoch 0
2025-04-12 10:58:53 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:53 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_29, value: {"_id": {"$oid": "67f10b97558ab0f6396b1427"}, "review": "Very bad quality, feels cheap.", "authId": "user_29", "datetime": "2025-03-11T08:35:47.362Z", "sentiment": null}, offset: 70403
2025-04-12 10:58:53 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_29
2025-04-12 10:58:53 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:53 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:54 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Text: {"_id": {"$oid": "67f10b97558ab0f6396b1427"}, "review": "Very bad quality, feels cheap.", "authId": "user_29", "datetime": "2025-03-11T08:35:47.362Z", "sentiment": null}%n
2025-04-12 10:58:54 [Worker-1] INFO  o.s.t.s.GoogleNaturalLanguageService - Sentiment: = magnitude: 0.7
score: -0.7

2025-04-12 10:58:54 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - Sentiment of the data magnitude: 0.7
score: -0.7

2025-04-12 10:58:54 [Worker-1] INFO  o.a.k.c.producer.ProducerConfig - ProducerConfig values: 
	acks = -1
	auto.include.jmx.reporter = true
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-55
	compression.gzip.level = -1
	compression.lz4.level = 9
	compression.type = none
	compression.zstd.level = 3
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = true
	enable.metrics.push = true
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.adaptive.partitioning.enable = true
	partitioner.availability.timeout.ms = 0
	partitioner.class = null
	partitioner.ignore.keys = false
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 2147483647
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

2025-04-12 10:58:54 [Worker-1] INFO  o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-04-12 10:58:54 [Worker-1] INFO  o.a.k.clients.producer.KafkaProducer - [Producer clientId=producer-55] Instantiated an idempotent producer.
2025-04-12 10:58:54 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.8.0
2025-04-12 10:58:54 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka commitId: 771b9576b00ecf5b
2025-04-12 10:58:54 [Worker-1] INFO  o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1744455534080
2025-04-12 10:58:54 [Worker-1] INFO  o.s.t.kafka.producer.Producer - Processing one random record...
2025-04-12 10:58:54 [kafka-producer-network-thread | producer-55] INFO  org.apache.kafka.clients.Metadata - [Producer clientId=producer-55] Cluster ID: 5L6g3nShT-eMCtK--X86sw
2025-04-12 10:58:54 [Worker-1] INFO  o.s.t.kafka.producer.Producer - sent one ProcessedMessage: ProcessedMessage{authId='user_29', sentiment=magnitude: 0.7
score: -0.7
}
2025-04-12 10:58:54 [kafka-producer-network-thread | producer-55] INFO  o.a.k.c.p.i.TransactionManager - [Producer clientId=producer-55] ProducerId set to 7059 with epoch 0
2025-04-12 10:58:54 [Worker-1] ERROR o.s.t.kafka.producer.Producer - Failed to send ProcessedMessage to Kafka
org.apache.kafka.common.errors.SerializationException: Can't convert value of class org.shyam.transform.kafka.model.ProcessedMessage to class org.apache.kafka.common.serialization.StringSerializer specified in value.serializer
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1047)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:991)
	at org.apache.kafka.clients.producer.KafkaProducer.send(KafkaProducer.java:873)
	at org.shyam.transform.kafka.producer.Producer.produce(Producer.java:47)
	at org.shyam.transform.kafka.producer.Producer.sentToTopic(Producer.java:31)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToKafka(ReviewsConsumer.java:47)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:42)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.ClassCastException: class org.shyam.transform.kafka.model.ProcessedMessage cannot be cast to class java.lang.String (org.shyam.transform.kafka.model.ProcessedMessage is in unnamed module of loader 'app'; java.lang.String is in module java.base of loader 'bootstrap')
	at org.apache.kafka.common.serialization.StringSerializer.serialize(StringSerializer.java:31)
	at org.apache.kafka.common.serialization.Serializer.serialize(Serializer.java:62)
	at org.apache.kafka.clients.producer.KafkaProducer.doSend(KafkaProducer.java:1044)
	... 10 common frames omitted
2025-04-12 10:58:54 [Worker-1] INFO  o.s.t.k.consumer.ConsumerTemplate - Processing message - key: user_20, value: {"_id": {"$oid": "67f10b97558ab0f6396b141e"}, "review": "Top-notch! Will definitely recommend.", "authId": "user_20", "datetime": "2025-02-18T12:03:20.168Z", "sentiment": null}, offset: 70404
2025-04-12 10:58:54 [Worker-1] INFO  o.s.t.kafka.consumer.ReviewsConsumer - ProcessedMessage key user_20
2025-04-12 10:58:54 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:10)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-04-12 10:58:54 [Worker-1] ERROR o.s.t.s.GoogleNaturalLanguageService - Error in creating  google client for sentiment : 
java.lang.IllegalStateException: Shutdown in progress
	at java.base/java.lang.ApplicationShutdownHooks.add(ApplicationShutdownHooks.java:67)
	at java.base/java.lang.Runtime.addShutdownHook(Runtime.java:250)
	at org.shyam.transform.service.GoogleNaturalLanguageService.registerShutdownHook(GoogleNaturalLanguageService.java:55)
	at org.shyam.transform.service.GoogleNaturalLanguageService.<init>(GoogleNaturalLanguageService.java:32)
	at org.shyam.transform.service.LanguageServiceFactory.createLanguageService(LanguageServiceFactory.java:12)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.sendToProcessing(ReviewsConsumer.java:51)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.processAndSend(ReviewsConsumer.java:40)
	at org.shyam.transform.kafka.consumer.ReviewsConsumer.consume(ReviewsConsumer.java:26)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.processRecords(ConsumerTemplate.java:46)
	at org.shyam.transform.kafka.consumer.ConsumerTemplate.startConsuming(ConsumerTemplate.java:70)
	at java.base/java.lang.Thread.run(Thread.java:1583)
